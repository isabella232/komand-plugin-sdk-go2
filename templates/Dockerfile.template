FROM komand/go-plugin-2:1.0
LABEL organization=komand
LABEL sdk=go
LABEL type=plugin

RUN mkdir -p /komand/plugins/bin
ADD . /go/src/{{ .PackageRoot }}
WORKDIR /go/src/{{ .PackageRoot}}

ADD ./plugin.spec.yaml /plugin.spec.yaml

RUN make plugin

# User to run plugin code. The two supported users are: root, nobody
USER root

ENTRYPOINT ["/komand/plugins/bin/{{.Name}}"]
